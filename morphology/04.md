# Development and debugging

## Lexicon construction

<!--N -->

So, you've got your morphotactics more or less sorted out, and you've made a good start on your morphophonological rules. Where are you going to get the lexemes ? Depending on the language you choose you may already have a beautifully prepared list of stems. For other languages there might be a dictionary with less elaborate systems of classes, perhaps traditional ones that underspecify the morphology, or perhaps ones that don't specify the morphology at all. In the worst case you may have to just rely on a Swadesh list or a simple list of inflected forms from a corpus. 

In any case, whether you have a complete system or just a list of inflected forms, the best idea is to work adding words to the lexicon by **frequency** of appearance in whichever corpus you have. You might have easy access to a corpus, if not you can use a [Wikipedia database backup dump](https://dumps.wikimedia.org/backup-index.html) or you can write a webcrawler for some online newspaper. You can use [`WikiExtractor.py`](https://svn.code.sf.net/p/apertium/svn/trunk/apertium-tools/WikiExtractor.py) script to extract raw text from Wiki dump.


1. Download the latest version of Guaraní Wikipedia.
You should get a compressed file `gnwiki-20191120-pages-articles-multistream.xml.bz2`.

2. Run `WikiExtractor.py` using the following command:

```
python WikiExtractor.py --infn gnwiki-20191120-pages-articles-multistream.xml.bz2
```
Now you have `wiki.txt` file.

We can get a frequency list using simple `bash` script:

```bash
cat wiki.txt | tr ' ' '\n' | sort | uniq -c | sort -nr > hitparade.txt
```

See the output like this:

```
head hitparade.txt 
  19665 ha
   6694 
   4350 peteĩ
   4299 de
   3581 umi
   3331 ha'e
   3066 avei
   2926 ary
   2293 pe
   2174 upe
```

We can find out the number of words in the frequency list:
```
wc -l hitparade.txt 
101089 hitparade.txt
```

Let's compare this output with part of speech and gloss in English. 

```
CCONJ "and"
CCONJ "and"
CCONJ "and"
PRON  "it, she, he"
ADP   "about"
NOUN  "of month"
NUM   "on the Nth"
NOUN  "zone, region"
ADV   "not"
VERB  "was"
NOUN  "year"
NOUN  "possibility"
NUM   "one"
NUM   "th"
VERB  "saying"
PRON  "it, she, he"
VERB  "happened"
```

The picture below shows a graphical representation of Zipf's law. 

<!-- Insert img FMT -->


As you can see the most frequent words are unsurprising for a text from a newspaper, words about time and place, closed category words like conjunctions, adpositions and pronouns and copula verbs. This was from a corpus of around 367,168 tokens, so the list won't be so representative for the language as a whole, but the bigger and more balanced the corpus the more legit the frequency list is going to be and the better it is going to represent the language that your analyser is likely to be asked to process.

## More on morphotactics 

When moving from making a morphological model of a few words from a grammar to making one that covers a whole corpus you are bound to come across some examples of things that are either underdescribed or not described at all in the extant grammars. For example, how loan words are treated and how to deal with numerals or abbreviations which take affixes according to how the words are pronounced and not how they are written.

### Loan words 
<!--N -->



### Numerals and abbreviations 
<!-- N -->

Numerals and abbreviations present a problem: they do not provide us with any information at all about how the word should be pronounced (as they are written in digits). Take a look at this following example: 

| Onohẽ           | iPod | ary  | 2001-me  | ha  | ary  | 2003-pe  | tienda online | vendeha    | puraheikuéra         | ha iTunes  |
|-----------------|------|------|----------|-----|------|----------|---------------|------------|----------------------|------------|
| 3P.release      | iPod | year | 2001-LOC | and | year | 2003-LOC | online shop   | sell-SUBST | song-PL              | and iTunes |
| (They) released | iPod | in   | 2001     | and | in   | 2003     | started to    | sell       | songs in online shop | and iTunes |
|                 |      |      |          |     |      |          |               |            |                      |            |

The ajacent suffix depends on the pronounciation of the final digit in the number, for example, `1` is pronounced as *peteĩ* where the final `ĩ` is nasal and `3` is pronounced as *mbohapy* where `y` is not nasal.

Thus we can have a lexicon of digits with the archiphoneme, for example,  `%{d%}` indicating whether the nasal alternation should be done or not.


Here is an excerpt from a transducer in lexc that handles numeral expressions:

### Guessers 
<!-- FMT -->

## Unit testing 
<!-- FMT -->

## Evaluation
<!-- FMT -->

### Coverage 

### Precision and recall 


## Generating paradigms 
<!-- FMT -->


